<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../assets/css/dashboard.css">
    <link rel="website icon" href="../assets/icon/owl.svg" />
</head>

<body>
    <nav class="menu-lateral" id="menuLateral">
        <div class="botao-menu" onclick="botaoMenu()">
            <img src="../assets/img/menu-hamburguer.png" alt="">
        </div>

        <div class="usuario">
            <h4 id="nomeDaEmpresa"></h4>
            <img src="../assets/img/usuario.png" alt="">
            <h4 id="nomeDoUsuario"></h4>
        </div>

        <ul>
            <li class="item-menu">
                <a href="./dashboard.html">
                    <span class="icone"><i class="bi bi-bar-chart-fill"></i></span>
                    <span class="texto">Computadores</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="../cadastroNovoFunc.html">
                    <span class="icone"><i class="bi bi-person-add"></i></span>
                    <span class="texto">Configuração</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="https://howlz.atlassian.net/servicedesk/customer/portal/1">
                    <span class="icone"><i class="bi bi-person-gear"></i></span>
                    <span class="texto">Suporte</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="../login.html">
                    <span class="icone"><i class="bi bi-box-arrow-in-right"></i></span>
                    <span class="texto" onclick="limparSessao()">Sair</span>
                </a>
            </li>

        </ul>

    </nav>
    <div class="content">
        <h2>Máquinas Monitoradas</h2>
        <div class="container" id="maquinas" style="gap: 10px;">
            <!-- <div class="maquina">
                <h3>Máquina 1</h3>
                <p class="status ativa">Status: Ativa</p>
                <p>Uso de CPU: </p>
                <p>Memória RAM: </p>
                <p>Espaço em Disco: </p>
                <a href="../dashboard/maquina.html"><button>Monitorar</button></a>
            </div> -->
        </div>
    </div>
    <script>

//função para quebrar linha das maquinas
        // for (let i = 0; i < array.length; i++) {
        //     const element = array[i];
        //     if (i % 5 == 0){
                
        //     }
        // }

        function botaoMenu() {
            var menuLateral = document.getElementById("menuLateral");
            var botaoMenuImg = document.getElementById("botaoMenuImg");

            menuLateral.classList.toggle("ver-menu");
            botaoMenuImg.style.display = menuLateral.classList.contains("ver-menu") ? "none" : "block";

            var content = document.querySelector(".content");
            content.classList.toggle("content-shift");
        }

        var nomeDaEmpresa = sessionStorage.getItem("NOME_EMPRESA");
        document.getElementById("nomeDaEmpresa").innerHTML = nomeDaEmpresa;

        var nomeDoUsuario = sessionStorage.getItem("NOME_USUARIO");
        document.getElementById("nomeDoUsuario").innerHTML = nomeDoUsuario;

        function limparSessao() {

            sessionStorage.clear();

            window.location = "/login";
        }

    fetch("/usuarios/contar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        fkGestorServer: sessionStorage.getItem("ID_USUARIO"),
      }),
    })
      .then(function (resposta) {

        if (resposta.ok) {
          console.log(resposta);

          resposta.json().then((json) => {
            console.log(json);
            console.log(JSON.stringify(json));

          for (let i = 0; i < json; i++) {
            const element = json[i];

            if (i % 5 == 0){
               maquinas.innerHTML += `<br>`; 
              }

            maquinas.innerHTML += `
                    <div class="maquina">
                        <h3>Máquina ${i + 1}</h3>
                        <p class="status ativa">Status: Ativa</p>
                        <p>Uso de CPU: 1</p>
                        <p>Memória RAM: 1</p>
                        <p>Espaço em Disco: 1</p>
                        <a href="../dashboard/maquina.html"><button>Monitorar</button></a>
                    </div>
                        `;
          }});

          //   fetch("/usuarios/maquinas", {
          //     method: "POST",
          //     headers: {
          //       "Content-Type": "application/json",
          //     },
          //     body: JSON.stringify({
          //       id: element.id,
          //     }),
          //   })
          //     .then(function (volta) {
          //       if (volta.ok) {
          //           volta.json().then((json) => {

          //               maquinas.innerHTML = `
          //           <div class="maquina">
          //               <h3>Máquina ${volta[i].idMaquina}</h3>
          //               <p class="status ativa">Status: Ativa</p>
          //               <p>Uso de CPU: ${volta[i].UsoCPU}</p>
          //               <p>Memória RAM: ${volta[i].MemRam}</p>
          //               <p>Espaço em Disco: ${volta[i].EspacoDisco}</p>
          //               <a href="../dashboard/maquina.html"><button>Monitorar</button></a>
          //           </div>
          //               `;
                    
          //           console.log(json);
          //           console.log(JSON.stringify(json));
          //         });
          //       } else {
          //         resposta.text().then((texto) => {
          //           console.log(texto);
          //         });
          //       }
          //     })
          //     .catch(function (erro) {
          //       console.log(erro);
          //     });
        //  }
        // } else {
          
        // }
      }})
      .catch(function (erro) {
        console.log(erro);
      });
    

    </script>
</body>

</html>